{"version":3,"file":"index.js","sources":["../src/core/observer/Dep.js","../src/core/observer/index.js","../src/core/instance/state.js","../src/core/utils/index.js","../src/compiler/html-parser.js","../src/compiler/text-parser.js","../src/compiler/parser.js","../src/compiler/codegen.js","../src/compiler/index.js","../src/core/instance/render.js","../src/core/instance/lifecycle.js","../src/core/utils/node-ops.js","../src/core/vdom/vnode.js","../src/core/instance/patch.js","../src/core/observer/Watcher.js","../src/core/instance/index.js"],"sourcesContent":["\r\nlet uid = 0;\r\n\r\nexport default class Dep {\r\n  constructor () {\r\n    this.id = uid++;\r\n    this.subs = [];\r\n  }\r\n\r\n  addSub (sub) {\r\n    this.subs.push(sub);\r\n  }\r\n\r\n  removeSub (sub) {\r\n    remove(this.subs, sub);\r\n  }\r\n\r\n  depend () {\r\n    if (Dep.target) {\r\n      Dep.target.addDep(this);\r\n    }\r\n  }\r\n\r\n  notify () {\r\n    const subs = this.subs.slice();\r\n    for (let i = 0, l = subs.length; i < l; i++) {\r\n      subs[i].update();\r\n    }\r\n  }\r\n}\r\n\r\nDep.target = null;\r\n\r\nfunction remove (arr, item) {\r\n  if (arr.length) {\r\n    const index = arr.indexOf(item);\r\n    if (index > -1) {\r\n      return arr.splice(index, 1);\r\n    }\r\n  }\r\n}\r\n\r\nDep.target = null;\r\nconst targetStack = [];\r\n\r\nexport function pushTarget (target) {\r\n  targetStack.push(target);\r\n  Dep.target = target;\r\n}\r\n\r\nexport function popTarget () {\r\n  targetStack.pop();\r\n  Dep.target = targetStack[targetStack.length - 1];\r\n}\r\n","import Dep from './Dep';\r\n\r\nexport function observe (data) {\r\n  const ob = new Observer(data);\r\n}\r\n\r\nclass Observer {\r\n  constructor (obj) {\r\n    this.walk(obj);\r\n  }\r\n\r\n  walk (obj) {\r\n    const keys = Object.keys(obj);\r\n    for (let i = 0; i < keys.length; i++) {\r\n      defineReactive(obj, keys[i]);\r\n    }\r\n  }\r\n}\r\n\r\nfunction defineReactive (obj, key, val,) {\r\n  const property = Object.getOwnPropertyDescriptor(obj, key);\r\n  if (property && property.configurable === false) {\r\n    return;\r\n  }\r\n\r\n  const dep = new Dep();\r\n\r\n  // cater for pre-defined getter/setters\r\n  const getter = property && property.get;\r\n  const setter = property && property.set;\r\n  if ((!getter || setter) && arguments.length === 2) {\r\n    val = obj[key];\r\n  }\r\n\r\n  Object.defineProperty(obj, key, {\r\n    enumerable: true,\r\n    configurable: true,\r\n    get: function reactiveGetter () {\r\n      const value = getter ? getter.call(obj) : val;\r\n      if (Dep.target) {\r\n        dep.depend();\r\n      }\r\n\r\n      return value;\r\n    },\r\n    set: function reactiveSetter (newVal) {\r\n\r\n    },\r\n  });\r\n}\r\n","import { observe } from '../observer/index.js';\r\n\r\nexport function initState (vm) {\r\n  const opt = vm.$options;\r\n\r\n  if (opt.data) {\r\n    initData(vm);\r\n  }\r\n}\r\n\r\nfunction initData (vm) {\r\n  const data = vm.$options.data;\r\n  vm._data = data;\r\n  observe(data);\r\n}\r\n","\r\nexport function getOuterHTML (el) {\r\n  if (el.outerHTML) {\r\n    return el.outerHTML;\r\n  } else {\r\n    const container = document.createElement('div');\r\n    container.appendChild(el.cloneNode(true));\r\n    return container.innerHTML;\r\n  }\r\n}\r\n\r\nexport function query (el) {\r\n  if (typeof el === 'string') {\r\n    const selected = document.querySelector(el);\r\n    if (!selected) {\r\n      return document.createElement('div');\r\n    }\r\n    return selected;\r\n  } else {\r\n    return el;\r\n  }\r\n}\r\n\r\nexport function isType (obj, type) {\r\n  return Object.prototype.toString.call(obj).toLowerCase() === `[object ${type}]`;\r\n}\r\n\r\nexport function deepCopy (out) {\r\n  out = out || {};\r\n\r\n  const str = JSON.stringify(out);\r\n\r\n  return JSON.parse(str);\r\n};\r\n\r\nexport function isDef (v) {\r\n  return v !== undefined && v !== null;\r\n}\r\n","\r\nfunction HtmlParser () {}\r\n\r\nHtmlParser.prototype = {\r\n\r\n  handler: null,\r\n\r\n  // regexps\r\n\r\n  startTagRe: /^<([^>\\s\\/]+)((\\s+[^=>\\s]+(\\s*=\\s*((\\\"[^\"]*\\\")|(\\'[^']*\\')|[^>\\s]+))?)*)\\s*\\/?\\s*>/m,\r\n  endTagRe: /^<\\/([^>\\s]+)[^>]*>/m,\r\n  attrRe: /([^=\\s]+)(\\s*=\\s*((\\\"([^\"]*)\\\")|(\\'([^']*)\\')|[^>\\s]+))?/gm,\r\n\r\n  parse: function (s, oHandler) {\r\n    if (oHandler) { this.contentHandler = oHandler; }\r\n\r\n    const i = 0;\r\n    let res, lc, lm, rc, index;\r\n    let treatAsChars = false;\r\n    const oThis = this;\r\n    while (s.length > 0) {\r\n      // Comment\r\n      if (s.substring(0, 4) == '<!--') {\r\n        index = s.indexOf('-->');\r\n        if (index != -1) {\r\n          this.contentHandler.comment(s.substring(4, index));\r\n          s = s.substring(index + 3);\r\n          treatAsChars = false;\r\n        } else {\r\n          treatAsChars = true;\r\n        }\r\n      } else if (s.substring(0, 2) == '</') { // end tag\r\n        if (this.endTagRe.test(s)) {\r\n          lc = RegExp.leftContext;\r\n          lm = RegExp.lastMatch;\r\n          rc = RegExp.rightContext;\r\n\r\n          lm.replace(this.endTagRe, function () {\r\n            return oThis.parseEndTag.apply(oThis, arguments);\r\n          });\r\n\r\n          s = rc;\r\n          treatAsChars = false;\r\n        } else {\r\n          treatAsChars = true;\r\n        }\r\n      } else if (s.charAt(0) == '<') { // start tag\r\n        if (this.startTagRe.test(s)) {\r\n          lc = RegExp.leftContext;\r\n          lm = RegExp.lastMatch;\r\n          rc = RegExp.rightContext;\r\n\r\n          lm.replace(this.startTagRe, function () {\r\n            return oThis.parseStartTag.apply(oThis, arguments);\r\n          });\r\n\r\n          s = rc;\r\n          treatAsChars = false;\r\n        } else {\r\n          treatAsChars = true;\r\n        }\r\n      }\r\n\r\n      if (treatAsChars) {\r\n        index = s.indexOf('<');\r\n        if (index == -1) {\r\n          this.contentHandler.chars(s);\r\n          s = '';\r\n        } else {\r\n          this.contentHandler.chars(s.substring(0, index));\r\n          s = s.substring(index);\r\n        }\r\n      }\r\n\r\n      treatAsChars = true;\r\n    }\r\n  },\r\n\r\n  parseStartTag: function (sTag, sTagName, sRest) {\r\n    const attrs = this.parseAttributes(sTagName, sRest);\r\n    this.contentHandler.start(sTagName, attrs);\r\n  },\r\n\r\n  parseEndTag: function (sTag, sTagName) {\r\n    this.contentHandler.end(sTagName);\r\n  },\r\n\r\n  parseAttributes: function (sTagName, s) {\r\n    const oThis = this;\r\n    const attrs = [];\r\n    s.replace(this.attrRe, function (a0, a1, a2, a3, a4, a5, a6) {\r\n      attrs.push(oThis.parseAttribute(sTagName, a0, a1, a2, a3, a4, a5, a6));\r\n    });\r\n    return attrs;\r\n  },\r\n\r\n  parseAttribute: function (sTagName, sAttribute, sName) {\r\n    let value = '';\r\n    if (arguments[7]) { value = arguments[8]; } else if (arguments[5]) { value = arguments[6]; } else if (arguments[3]) { value = arguments[4]; }\r\n\r\n    const empty = !value && !arguments[3];\r\n    return {\r\n      name: sName,\r\n      value: empty ? null : value,\r\n    };\r\n  },\r\n};\r\n\r\nexport default new HtmlParser();\r\n","const tagRE = /\\{\\{((?:.|\\n)+?)\\}\\}/g;\r\n\r\nexport default function parseText (text) {\r\n  // text 如 '{{price}} 元' 或者 '价格 {{price}}' 形式\r\n  if (!tagRE.test(text)) {\r\n    return;\r\n  }\r\n\r\n  text = text.trim();\r\n\r\n  const tokens = [];\r\n  let lastIndex = tagRE.lastIndex = 0;\r\n  let match, index;\r\n  while ((match = tagRE.exec(text))) {\r\n    index = match.index;\r\n    // push text token\r\n    if (index > lastIndex) {\r\n      // '价格 {{price}}' 情况下，token.push('\"价格 \"')\r\n      tokens.push(JSON.stringify(text.slice(lastIndex, index)));\r\n    }\r\n    // tag token\r\n    const exp = match[1].trim();\r\n    // token.push('_s(price)') , _s 在 core/instance/render.js 中定义\r\n    tokens.push(`_s(_data.${exp})`);\r\n    lastIndex = index + match[0].length;\r\n  }\r\n  if (lastIndex < text.length) {\r\n    // '{{price}} 元' 情况下，token.push('\" 元\"')\r\n    tokens.push(JSON.stringify(text.slice(lastIndex)));\r\n  }\r\n  // 最终返回 '_s(price)+\" 元\"' 或者 '\"价格 \"+_s(price)'\r\n  return tokens.join('+');\r\n}\r\n","import parseHTML from './html-parser';\r\nimport parseText from './text-parser';\r\n\r\nconst onRE = /^@|^m-on:/;\r\nconst dirRE = /^m-|^@|^:/;\r\nconst forAliasRE = /(.*?)\\s+(?:in|of)\\s+(.*)/;\r\nconst forIteratorRE = /\\((\\{[^}]*\\}|[^,]*),([^,]*)(?:,([^,]*))?\\)/;\r\n\r\nconst argRE = /:(.*)$/;\r\nconst bindRE = /^:|^m-bind:/;\r\nconst modifierRE = /\\.[^.]+/g;\r\n\r\nexport function parse (\r\n  template,\r\n  options\r\n) {\r\n  // 节点栈\r\n  const stack = [];\r\n  // 根节点，最终改回返回\r\n  let root;\r\n  // 当前的父节点\r\n  let currentParent;\r\n\r\n  parseHTML.parse(template, {\r\n    // node 的开始\r\n    start (tag, attrs, unary) {\r\n      // unary 是否一元标签，如 <img/>\r\n\r\n      const element = {\r\n        type: 1,\r\n        tag,\r\n        // attrsList 数组形式\r\n        attrsList: attrs,\r\n        // attrsMap 对象形式，如 {id: 'app', 'm-text': 'xxx'}\r\n        attrsMap: makeAttrsMap(attrs),\r\n        parent: currentParent,\r\n        children: [],\r\n      };\r\n\r\n      // 处理 m-for ，生成 element.for, element.alias\r\n      processFor(element);\r\n      // 处理 m-if ，生成 element.if, element.else, element.elseif\r\n      processIf(element);\r\n      // 处理 m-once ，生成 element.once\r\n      processOnce(element);\r\n      // 处理 key ，生成 element.key\r\n      processKey(element);\r\n\r\n      // 处理属性\r\n      // 第一，处理指令：m-bind m-on 以及其他指令的处理\r\n      // 第二，处理普通的 html 属性，如 style class 等\r\n      processAttrs(element);\r\n\r\n      // tree management\r\n      if (!root) {\r\n        // 确定根节点\r\n        root = element;\r\n      }\r\n      if (currentParent) {\r\n        // 当前有根节点\r\n        currentParent.children.push(element);\r\n        element.parent = currentParent;\r\n      }\r\n      if (!unary) {\r\n        // 不是一元标签（<img/> 等）\r\n        currentParent = element;\r\n        stack.push(element);\r\n      }\r\n    },\r\n    // node 的结束\r\n    end () {\r\n      // pop stack\r\n      stack.length -= 1;\r\n      currentParent = stack[stack.length - 1];\r\n    },\r\n    // 字符\r\n    chars (text) {\r\n      const children = currentParent.children;\r\n      const expression = parseText(text); // 如 '_s(price)+\" 元\"' ，_s 在 core/instance/render.js 中定义\r\n      // 处理字符\r\n      children.push({\r\n        type: 2,\r\n        expression,\r\n        text,\r\n      });\r\n    },\r\n    // 注释内容\r\n    comment (text) {\r\n      currentParent.children.push({\r\n        type: 3,\r\n        text,\r\n        isComment: true,\r\n      });\r\n    },\r\n  });\r\n  return root;\r\n}\r\n\r\nfunction makeAttrsMap (attrs) {\r\n  const map = {};\r\n  for (let i = 0, l = attrs.length; i < l; i++) {\r\n    map[attrs[i].name] = attrs[i].value;\r\n  }\r\n  return map;\r\n}\r\n\r\n// 处理 m-for\r\nfunction processFor (el) {\r\n  let exp;\r\n  // 获取表达式，例如 'item in list'\r\n  if ((exp = getAndRemoveAttr(el, 'm-for'))) {\r\n    // inMatch 即 ['item in list', 'item', 'list']\r\n    const inMatch = exp.match(forAliasRE);\r\n    if (!inMatch) {\r\n      return;\r\n    }\r\n    el.for = inMatch[2].trim(); // 'list'\r\n    const alias = inMatch[1].trim(); // 'item'\r\n\r\n    // 如果是 '(item, index) in list' 情况下\r\n    // iteratorMatch 即 [\"(item, index)\", \"item\", \"index\", undefined]\r\n    const iteratorMatch = alias.match(forIteratorRE);\r\n    if (iteratorMatch) {\r\n      el.alias = iteratorMatch[1].trim(); // 'item'\r\n      el.iterator1 = iteratorMatch[2].trim(); // 'index'\r\n      if (iteratorMatch[3]) {\r\n        el.iterator2 = iteratorMatch[3].trim();\r\n      }\r\n    } else {\r\n      // 普通的 'item in list' 这种情况\r\n      el.alias = alias; // 'item'\r\n    }\r\n  }\r\n}\r\n\r\n// 处理 m-if\r\nfunction processIf (el) {\r\n  // 获取表达式\r\n  const exp = getAndRemoveAttr(el, 'm-if');\r\n  if (exp) {\r\n    el.if = exp;\r\n  } else {\r\n    if (getAndRemoveAttr(el, 'm-else') != null) {\r\n      el.else = true;\r\n    }\r\n    const elseif = getAndRemoveAttr(el, 'm-else-if');\r\n    if (elseif) {\r\n      el.elseif = elseif;\r\n    }\r\n  }\r\n}\r\n\r\n// 处理 m-once\r\nfunction processOnce (el) {\r\n  const once = getAndRemoveAttr(el, 'm-once');\r\n  if (once != null) {\r\n    el.once = true;\r\n  }\r\n}\r\n\r\n// 处理 key\r\nfunction processKey (el) {\r\n  const exp = getBindingAttr(el, 'key');\r\n  if (exp) {\r\n    el.key = exp;\r\n  }\r\n}\r\n\r\nfunction processAttrs (el) {\r\n  // 获取属性列表\r\n  const list = el.attrsList;\r\n  let i, l, name, rawName, value, modifiers, isProp;\r\n  for (i = 0, l = list.length; i < l; i++) {\r\n    // 获取属性的 name 和 value\r\n    name = rawName = list[i].name;\r\n    value = list[i].value;\r\n\r\n    if (dirRE.test(name)) { // 如果该属性是指令，如 m- @ : 特性\r\n      // mark element as dynamic\r\n      el.hasBindings = true;\r\n\r\n      if (bindRE.test(name)) { // m-bind ，如 'm-bind:class'\r\n        name = name.replace(bindRE, ''); // 去掉 name 中的 'm-bind:'\r\n        // el.attrs.push(name, value)\r\n        addAttr(el, name, value);\r\n      } else if (onRE.test(name)) { // m-on ，如 'm-on:click'\r\n        name = name.replace(onRE, ''); // 去掉 name 中的 'm-on'\r\n        // el.events[name] = [{value: value}, ...] // 多个事件就数组形式，单个时间就普通对象形式 {value: value}\r\n        addHandler(el, name, value);\r\n      } else { // 普通指令 如 m-show\r\n        name = name.replace(dirRE, ''); // 去掉指令前缀 'm-show' -> 'show'\r\n        // el.directives.push({name, rawname, value})\r\n        addDirective(el, name, rawName, value);\r\n      }\r\n    } else { // 不是指令\r\n      // 普通属性加入 el.attrs\r\n      // el.attrs.push(name, value)\r\n      addAttr(el, name, JSON.stringify(value));\r\n    }\r\n  }\r\n}\r\n\r\nexport function addHandler (el, name, value) {\r\n  const events = el.events || (el.events = {}); // 事件都存储在 el.events 中\r\n\r\n  // 新事件\r\n  const newHandler = { value, };\r\n  // 看是否已有 name 的其他事件\r\n  const handlers = events[name];\r\n  if (Array.isArray(handlers)) {\r\n    handlers.push(newHandler);\r\n  } else if (handlers) {\r\n    events[name] = [handlers, newHandler];\r\n  } else {\r\n    // 存储事件\r\n    events[name] = newHandler;\r\n  }\r\n}\r\n\r\nexport function addAttr (el, name, value) {\r\n  (el.attrs || (el.attrs = [])).push({ name, value, });\r\n}\r\n\r\nexport function addDirective (el, name, rawName, value\r\n) {\r\n  (el.directives || (el.directives = [])).push({ name, rawName, value, });\r\n}\r\n\r\nexport function getAndRemoveAttr (el, name) {\r\n  let val;\r\n  if ((val = el.attrsMap[name]) != null) {\r\n    const list = el.attrsList;\r\n    for (let i = 0, l = list.length; i < l; i++) {\r\n      if (list[i].name === name) {\r\n        list.splice(i, 1);\r\n        break;\r\n      }\r\n    }\r\n  }\r\n  return val;\r\n}\r\n\r\nexport function getBindingAttr (el, name, getStatic) {\r\n  const dynamicValue =\r\n      getAndRemoveAttr(el, ':' + name) ||\r\n      getAndRemoveAttr(el, 'v-bind:' + name);\r\n  if (dynamicValue != null) {\r\n    return parseFilters(dynamicValue);\r\n  } else if (getStatic !== false) {\r\n    const staticValue = getAndRemoveAttr(el, name);\r\n    if (staticValue != null) {\r\n      return JSON.stringify(staticValue);\r\n    }\r\n  }\r\n}\r\n\r\nfunction parseFilters () {\r\n\r\n}\r\n","\r\nexport function generate (\r\n  ast,\r\n) {\r\n  const code = ast ? genElement(ast) : '_c(\"div\")';\r\n  return `with(this){return ${code}}`;\r\n}\r\n\r\nfunction genElement (node) {\r\n  let tempStr = '';\r\n  // 如果node是个dom节点\r\n  if (node.type === 1) {\r\n    // 无子元素\r\n    if (node.children.length === 0) {\r\n      tempStr = `_c('${node.tag}',${JSON.stringify(node.attrsMap)})`;\r\n    } else { // 有子元素\r\n      const children = node.children;\r\n      let h_childs = [];\r\n      for (let i = 0; i < children.length; i++) {\r\n        h_childs.push(genElement(children[i]));\r\n      }\r\n      h_childs = '[' + h_childs.join(',') + ']';\r\n      tempStr = `_c('${node.tag}',${JSON.stringify(node.attrsMap)},${h_childs})`;\r\n    }\r\n  } else if (node.type === 2) { // 如果node是文字\r\n    tempStr = node.expression ? node.expression : `'${node.text}'`;\r\n    tempStr = tempStr.replace(/\\n|\\r/g, '');\r\n  }\r\n  return tempStr;\r\n}\r\n","\r\nimport { parse } from './parser';\r\nimport { generate } from './codegen';\r\n\r\nexport function createCompilerCreator (template) {\r\n  const ast = parse(template.trim()); // 1\r\n\r\n  const renderStr = generate(ast);\r\n\r\n  return createFunction(renderStr);\r\n  // return {\r\n  //   ast,\r\n  //   render: code.render,\r\n  // };\r\n}\r\n\r\nfunction createFunction (code, errors) {\r\n  try {\r\n    return new Function(code);\r\n  } catch (err) {\r\n    errors.push({ err, code, });\r\n    return () => {};\r\n  }\r\n}\r\n","import { deepCopy, isType } from '../utils/index';\r\n\r\nexport function initRender (vm) {\r\n  vm._vnode = null;\r\n  vm._c = function (nodeName, attributes, children) {\r\n    let node = {};\r\n    const directives = [];\r\n    const mDirect = /^m-/;\r\n    let isNeed = true;\r\n\r\n    for (const attr in attributes) {\r\n      if (mDirect.test(attr)) {\r\n        directives.push({\r\n          key: attr,\r\n          prop: attributes[attr],\r\n        });\r\n      }\r\n    }\r\n\r\n    // 只考虑m-if、m-for 的情况\r\n    directives.forEach(item => {\r\n      if (item.key === 'm-if') {\r\n        const propValue = new Function(`return this.data.${item.prop}`).call(this);\r\n        isNeed = propValue === true;\r\n      } else if (item.key === 'm-model') {\r\n        const propValue = new Function(`return this.data.${item.prop}`).call(this);\r\n        node.value = propValue;\r\n      }\r\n    });\r\n\r\n    // 如果\r\n    if (children && isType(children, 'array')) {\r\n      children = children.filter(child => {\r\n        return child !== undefined;\r\n      });\r\n    }\r\n\r\n    // 不需要的设置为 undefined\r\n    if (!isNeed) {\r\n      return undefined;\r\n    }\r\n\r\n    node = deepCopy({\r\n      tag: nodeName,\r\n      attributes: attributes || {},\r\n      children: children,\r\n      key: attributes && attributes.key,\r\n    }, node);\r\n    return node;\r\n  };\r\n\r\n  vm._s = function (expression) {\r\n    return expression;\r\n  };\r\n}\r\n\r\nexport function renderMixin (Kue) {\r\n  Kue.prototype._render = function () {\r\n    const vm = this;\r\n    const { render, } = vm.$options;\r\n\r\n    const vnode = render.call(vm);\r\n\r\n    return vnode;\r\n  };\r\n}\r\n","\r\nexport function lifecycleMixin (Kue) {\r\n  Kue.prototype._update = function (vnode) {\r\n    const vm = this;\r\n    const prevEl = vm.$el;\r\n    const prevVnode = vm._vnode;\r\n    vm._vnode = vnode;\r\n    // Vue.prototype.__patch__ is injected in entry points\r\n    // based on the rendering backend used.\r\n    if (!prevVnode) {\r\n      // initial render\r\n      vm.$el = vm.__patch__(vm.$el, vnode);\r\n    } else {\r\n      // updates\r\n      vm.$el = vm.__patch__(prevVnode, vnode);\r\n    }\r\n    if (prevEl) {\r\n      prevEl.__vue__ = null;\r\n    }\r\n    if (vm.$el) {\r\n      vm.$el.__vue__ = vm;\r\n    }\r\n  };\r\n}\r\n","\r\nexport function createElement (tagName, vnode) {\r\n  const elm = document.createElement(tagName);\r\n  if (tagName !== 'select') {\r\n    return elm;\r\n  }\r\n  // false or null will remove the attribute but undefined will not\r\n  if (vnode.data && vnode.data.attrs && vnode.data.attrs.multiple !== undefined) {\r\n    elm.setAttribute('multiple', 'multiple');\r\n  }\r\n  return elm;\r\n}\r\n\r\nexport function createElementNS (namespace, tagName) {\r\n  return document.createElementNS(namespaceMap[namespace], tagName);\r\n}\r\n\r\nexport function createTextNode (text) {\r\n  return document.createTextNode(text);\r\n}\r\n\r\nexport function createComment (text) {\r\n  return document.createComment(text);\r\n}\r\n\r\nexport function insertBefore (parentNode, newNode, referenceNode) {\r\n  parentNode.insertBefore(newNode, referenceNode);\r\n}\r\n\r\nexport function removeChild (node, child) {\r\n  node.removeChild(child);\r\n}\r\n\r\nexport function appendChild (node, child) {\r\n  node.appendChild(child);\r\n}\r\n\r\nexport function parentNode (node) {\r\n  return node.parentNode;\r\n}\r\n\r\nexport function nextSibling (node) {\r\n  return node.nextSibling;\r\n}\r\n\r\nexport function tagName (node) {\r\n  return node.tagName;\r\n}\r\n\r\nexport function setTextContent (node, text) {\r\n  node.textContent = text;\r\n}\r\n\r\nexport function setStyleScope (node, scopeId) {\r\n  node.setAttribute(scopeId, '');\r\n}\r\n\r\nconst namespaceMap = {\r\n  svg: 'http://www.w3.org/2000/svg',\r\n  math: 'http://www.w3.org/1998/Math/MathML',\r\n};\r\n","\r\nexport default class VNode {\r\n  constructor (tag, data, elm) {\r\n    this.tag = tag;\r\n    this.data = data;\r\n    this.elm = elm;\r\n    this.children = [];\r\n  }\r\n}\r\n","import { isDef } from '../utils/index';\r\nimport * as nodeOps from '../utils/node-ops';\r\nimport VNode from '../vdom/vnode'; ;\r\n\r\nfunction patch (oldVnode, vnode) {\r\n  const isRealElement = isDef(oldVnode.nodeType);\r\n\r\n  if (isRealElement) {\r\n    oldVnode = emptyNodeAt(oldVnode);\r\n  }\r\n\r\n  const oldElm = oldVnode.elm;\r\n  const parentElm = nodeOps.parentNode(oldElm);\r\n\r\n  createElm(vnode, parentElm);\r\n};\r\n\r\nfunction emptyNodeAt (elm) {\r\n  return new VNode(nodeOps.tagName(elm).toLowerCase(), {}, elm);\r\n}\r\n\r\nexport function patchInit (Kue) {\r\n  // Kue.prototype.\r\n\r\n  Kue.prototype.__patch__ = patch;\r\n}\r\n\r\nfunction createElm (\r\n  vnode,\r\n  parentElm,\r\n\r\n) {\r\n  const data = vnode.data;\r\n  const children = vnode.children;\r\n  const tag = vnode.tag;\r\n  if (isDef(tag)) {\r\n    vnode.elm = nodeOps.createElement(tag, vnode);\r\n\r\n    createChildren(vnode, children);\r\n\r\n    insert(parentElm, vnode.elm);\r\n  } else {\r\n    vnode.elm = nodeOps.createTextNode(vnode.text);\r\n    insert(parentElm, vnode.elm);\r\n  }\r\n}\r\n\r\nfunction insert (parent, elm) {\r\n  if (isDef(parent)) {\r\n    nodeOps.appendChild(parent, elm);\r\n  }\r\n}\r\n\r\nfunction createChildren (vnode, children, insertedVnodeQueue) {\r\n  if (Array.isArray(children)) {\r\n    for (let i = 0; i < children.length; ++i) {\r\n      createElm(children[i], insertedVnodeQueue, vnode.elm, null, true, children, i);\r\n    }\r\n  } else if (isPrimitive(vnode.text)) {\r\n    nodeOps.appendChild(vnode.elm, nodeOps.createTextNode(String(vnode.text)));\r\n  }\r\n}\r\n\r\nexport function isPrimitive (value) {\r\n  return (\r\n    typeof value === 'string' ||\r\n    typeof value === 'number' ||\r\n    // $flow-disable-line\r\n    typeof value === 'symbol' ||\r\n    typeof value === 'boolean'\r\n  );\r\n}\r\n","import { pushTarget, popTarget } from './Dep';\r\n\r\nlet uid = 0;\r\n\r\nexport default class Watcher {\r\n  constructor (vm, expOrFn, cb) {\r\n    this.id = uid++;\r\n    this.vm = vm;\r\n    this.expOrFn = expOrFn;\r\n    this.cb = cb;\r\n    this.value = null;\r\n    this.deps = [];\r\n    this.getter = null;\r\n\r\n    if (typeof expOrFn === 'function') {\r\n      this.getter = expOrFn;\r\n    } else {\r\n      this.getter = parseGetter(expOrFn);\r\n    }\r\n    this.value = this.get();\r\n  }\r\n\r\n  update () {\r\n    const newValue = this.get();\r\n    const oldVal = this.value;\r\n    this.value = newValue;\r\n    this.cb.call(this.bm, newValue, oldVal);\r\n  }\r\n\r\n  addDep (dep) {\r\n    dep.addSub(dep);\r\n    this.deps.push(dep);\r\n  }\r\n\r\n  get () {\r\n    pushTarget(this);\r\n    const value = this.getter.call(this.bm, this.bm);\r\n    popTarget();\r\n    return value;\r\n  }\r\n}\r\n\r\nconst parseGetter = (exp) => {\r\n  if (/[^\\w.$]/.test(exp)) return;\r\n\r\n  return (obj) => getValue(obj, exp);\r\n};\r\n\r\nfunction getValue (target, path) {\r\n  if (path in target) {\r\n    const v = target[path];\r\n    return v;\r\n  }\r\n  let val = target;\r\n  path.split('.').forEach(k => {\r\n    val = val[k];\r\n  });\r\n  return val;\r\n};\r\n","\r\nimport { initState } from './state';\r\nimport { getOuterHTML, query } from '../utils/index';\r\nimport { createCompilerCreator } from '../../compiler/index';\r\nimport { initRender, renderMixin } from './render';\r\n\r\nimport { lifecycleMixin } from './lifecycle';\r\nimport { patchInit } from './patch';\r\nimport Watcher from '../observer/Watcher';\r\n\r\nexport default function Kue (options) {\r\n  this._init(options);\r\n}\r\n\r\nKue.prototype._init = function (options) {\r\n  this.$options = options;\r\n  initState(this);\r\n  initRender(this);\r\n\r\n  if (this.$options.el) {\r\n    this.$mount(this.$options.el);\r\n  }\r\n}\r\n;\r\n\r\nlifecycleMixin(Kue);\r\npatchInit(Kue);\r\nrenderMixin(Kue);\r\n\r\nKue.prototype.$mount = function () {\r\n  const options = this.$options;\r\n\r\n  this.$el = query(options.el);\r\n\r\n  const template = getOuterHTML(this.$el);\r\n  const vm = this;\r\n\r\n  // this.$el = template;\r\n\r\n  const render = createCompilerCreator(template);\r\n  options.render = render;\r\n\r\n  const updateComponent = () => {\r\n    vm._update(vm._render());\r\n  };\r\n\r\n  new Watcher(vm, updateComponent, () => {});\r\n}\r\n\r\n;\r\n"],"names":["uid","Dep","id","subs","sub","push","remove","target","addDep","slice","i","l","length","update","arr","item","index","indexOf","splice","targetStack","pushTarget","popTarget","pop","observe","data","ob","Observer","obj","walk","keys","Object","defineReactive","key","val","property","getOwnPropertyDescriptor","configurable","dep","getter","get","setter","set","arguments","defineProperty","enumerable","reactiveGetter","value","call","depend","reactiveSetter","newVal","initState","vm","opt","$options","initData","_data","getOuterHTML","el","outerHTML","container","document","createElement","appendChild","cloneNode","innerHTML","query","selected","querySelector","isType","type","prototype","toString","toLowerCase","deepCopy","out","str","JSON","stringify","parse","isDef","v","undefined","HtmlParser","handler","startTagRe","endTagRe","attrRe","s","oHandler","contentHandler","lm","rc","treatAsChars","oThis","substring","comment","test","RegExp","lastMatch","rightContext","replace","parseEndTag","apply","charAt","parseStartTag","chars","sTag","sTagName","sRest","attrs","parseAttributes","start","end","a0","a1","a2","a3","a4","a5","a6","parseAttribute","sAttribute","sName","empty","name","tagRE","parseText","text","trim","tokens","lastIndex","match","exec","exp","join","onRE","dirRE","forAliasRE","forIteratorRE","bindRE","template","options","stack","root","currentParent","parseHTML","tag","unary","element","attrsList","attrsMap","makeAttrsMap","parent","children","processFor","processIf","processOnce","processKey","processAttrs","expression","isComment","map","getAndRemoveAttr","inMatch","alias","iteratorMatch","iterator1","iterator2","elseif","once","getBindingAttr","list","rawName","hasBindings","addAttr","addHandler","addDirective","events","newHandler","handlers","Array","isArray","directives","getStatic","dynamicValue","parseFilters","staticValue","generate","ast","code","genElement","node","tempStr","h_childs","createCompilerCreator","renderStr","createFunction","errors","Function","err","initRender","_vnode","_c","nodeName","attributes","mDirect","isNeed","attr","prop","forEach","propValue","filter","child","_s","renderMixin","Kue","_render","render","vnode","lifecycleMixin","_update","prevEl","$el","prevVnode","__patch__","__vue__","tagName","elm","multiple","setAttribute","createTextNode","parentNode","VNode","patch","oldVnode","isRealElement","nodeType","emptyNodeAt","oldElm","parentElm","nodeOps","createElm","patchInit","createChildren","insert","insertedVnodeQueue","isPrimitive","String","Watcher","expOrFn","cb","deps","parseGetter","newValue","oldVal","bm","addSub","getValue","path","split","k","_init","$mount","updateComponent"],"mappings":"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"}